<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <h2>Email Validation</h2>
    Only Siena Email Address:
    <form id = "emailForm">
        <input type = "text" id = "emailAddress" name="emailAddress"></form>
        <input type = "submit" id="emailAddress">
    </form>
    <span id="emailError" class="error"></span>

    <script>
        function validateEmail() {
					  let isValid = false;
            const emailAddress = getElementById("emailAddress");
            const emailError = getElementById("emailError")
            emailError.textContent("");
            
            if (emailAddress === "" || !emailAddress.includes("@")) {
                emailError.textContent("Please enter a valid email address");
            } else {
                isValid = true;
                console.log("Email is valid: ", emailAddress);
                
            }
            
            if(isValid){
            // This submitRequest is a custom function that will be called when everything is valid
	            submitRequest();
            }

}
id("input-form").addEventListener("submit",function(e) {
    e.preventDefault();
    submitRequest();
});

function makeRequest(){
    let url = "https://macpro.csis410.com/data";

    //create a new form data
    let params = new FormData();
    params.append(getElementById("emailForm"),getElementById("emailAddress").value);
   
    //Fetch now with a method of POST and the param data in body
    fetch(url, { method: "POST", body: params})
      .then(statusCheck)
      .then((response) => response.json())
      .then((response) => response.json())
      .then((data) => updateResults(data))
      .catch(handleError);
}  

function updateResults(data){
    
}

function handleError(error){
    console.error(error);
}

async function statusCheck(res){
    if(!res.ok){
        throw new Error(await res.text());
    }
    return res;
}
    </script>
</body>
</html>